# 视频制作

## 一阶段

### 起因

视频是新时代的文学。我认为我需要在写作文字之余，多多花时间在视频创作上。

我高中毕业那段时间学习过使用绘声绘影制作视频，并且发布了我第一个视频。个人认为制作的还是不错的，想表达的意思其实都有表达出来，只是字幕问题比较严重，以及没有特效。所以感觉在视频内容传达方面存在一些问题。

不过总体来说，我觉得我的第一个项目最大的问题是，在我之后想要重新编辑它的时候，**整个工程我已经找不到了**。生活中这种情况是常有的，我们总以为存放在硬盘里的数据是永恒的，但其实一旦找不到它，或者不再使用它，亦或者换电脑，这个数据也就不存在了。

我大学了解了git，所以，对于文本类文件的"永恒存储"有了自己的看法，现在，**我希望这种基于文本的分布式存储与项目管理方式的优点可以移植到视频制作上来**。

因为种种原因，我现在的工作环境已经完全切换到了Linux上。所以我无法再使用绘声绘影，也无法去百度寻找破解版的PR。我决定拥抱Linux下的视频制作软件。

Linux下的视频制作软件有很多，不过也是因为Linux环境问题，我没能设置一个好看的主题，导致所有的应用软件都多少长的有点丑，而且，我担心这些开源视频软件的工程，也会出现我第一个视频一样的情况——无法再未来再次生成。基于已经有对git工具对认识和理解，我开始尝试使用命令行——文本化的形式去编辑视频。

### 学习路线

- 总耗时（略少于1天工作时间）
- 准备材料
  - 视频录制工具：OBS
  - 剪辑工具：ffmpeg
  - 创意/内容：视频制作本身


### 视频脚本

#### 视频目的

成功生成制作上传第一个视频

1. 本地视频素材的保存
2. 视频分镜的保存
3. 视频工程的保存



#### 视频内容

1. 录制屏幕，并设置视频存放地址
2. 编写视频内容
3. 学习命令行剪辑
4. 整理命令行剪辑的笔记
5. 生成视频
6. 上传视频



#### 问题总结

上传了视频后发现了两大块问题，第一块是视频内容方面，另一块是视频剪辑方面。

视频内容方面：
1. 我为了录制一个16:9的视频，所以购置了一个4K屏幕，导致显示内容过小。
2. 出现一次OBS视频录制出错。
3. 视频剪辑时未考虑到黑白闪烁的问题。

视频剪辑方面：
1. 现在的工作流程是使用Arctime确定片段，导出文件后通过脚本生成clip，然后再把clip拼接。太麻烦了
2. ffmpeg裁剪视频太慢了


#### 视频成果

- [命令行剪辑笔记](../../../技术/视频剪辑.md)
- [上传了视频](https://b23.tv/JYkLoqQ) (在阶段2删除。)



## 二阶段

### 起因

上一个阶段中，使用ffmpeg时遇到了较长时间的等待，我认为这是我对ffmpeg这把"瑞士军刀"使用不当造成的。并且，第一个视频相当粗糙，没有"字幕"、"连续音频"以及"转场特效"等，更何况对视频素材的修改、裁剪、缩放等效果都没有。

### 学习路线/视频内容

总耗时：图书馆一个下午+家中一个下午，约10个小时。

1. 了解ffmpeg大致构成和功能
   - 《FFmpeg从入门到精通》
   - 三大模块——ffmpeg、ffplay、ffprobe
   - ffmpeg组成部分——AVFormat、AVCodec、AVFilter、swscale、swresample
2. 学习ffmpeg音频录制方法~~，与obs音频录制区别~~
3. 学习ffmpeg添加字幕
4. 学习ffmpeg转场特效
5. 编写学习笔记，编写视频脚本，编写视频总结
6. 制作并上传视频



### 视频录制

1. Linux下如何通过ffmpeg录制视频？
   - X11全屏录制：`ffmpeg -f x11grab -i :0.0 -framerate 60 [output.mp4]`
   - framebuffer（无图形界面）录制：`ffmpeg -f fbdev -i /dev/fb0 -framerate 60 [output.mp4]`



### 阶段总结

这个阶段算是入门了ffmpeg，但是还有很多内容需要学习。特别是ffmpeg的组成部分，除了编解码以外，还有过滤器特效等等，需要慢慢看，慢慢学。

我现在无法整P上传视频到B站，所以暂时不用究竟上传B站的事情了。现在考虑的有以下几点：

1. 如何实现网页视频流？从而支持Web笔记的视频支持？
2. 如何管理本地视频？
3. 如何更方便的制作视频？



第一个问题是最主要的，我希望我的视频和图片可以嵌入笔记内，现在图片嵌入已经实现了，未来可能会有交互操作需要录制视频，所以现在先考虑视频嵌入的问题。一种方法是上传到B站这样的平台，然后使用HTML嵌入。但我既然自己有个服务器，我想我还是可以用自己的办法。

第二个问题是，现在的视频其实也是工程化生成的（脚本工程），所以工程到成片，成片的使用，我想都还需要进行管理。

第三个问题现在不急，第三个问题就是现在感觉制作视频不方便，但其实我对ffmpeg的理解和掌握还不够，所以想要更方便的制作视频，还得先学ffmpeg。



这么感觉这个阶段其实还没有走完，所以还是先计划继续[学习FFmpeg](./FFmpeg%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92.md)。




## 三阶段

### 起因

经过一阶段后的视频剪辑，我认为有一个非常主要的问题，是这个阶段需要改进的地方——优化视频剪辑流程，提高精剪效率。

上一个阶段中，视频剪辑主要依靠Arctime与命令行，Arctime的软件结构不能很好的与我系统适配，操作不便，而且Arctime只能编辑一个视频，完全做不到类似PR多视频源导入的事情。最后就是整个视频没能工程可视化，现在完全就是源文件、脚本文件打了一个包，太潦草了。



### 参考资料

- [淘系的音视频编辑方案：非线性编辑引擎](https://mp.weixin.qq.com/s/fJrRdxYwfA2Oa1oUW95mYQ)



### 设计

我希望设计一个**基于Web浏览器的本地多视频时间轴标记工具**。原型设计大致如下：

### 实现步骤

1. 查找开源的Web视频浏览技术
2. 分析技术，整理笔记
3. 其他分析与问题
4. 制作网页工具
5. 标记多视频，完成剪辑
6. 上传视频
